
---

#42Seoul #graphics #memo

---

minirt logic

1. 원시 도형의 중점과 방향 벡터를 입력받는다.
2. 중점과 방향 벡터가 별도로 있으면 중점에는 이동 행렬을, 벡터에는 회전 행렬을 별도로 적용해야 한다. 그러면 행렬은 압축하여 연산량을 줄일 수 없으므로
	1. 점 1(중점)과 점 2(중점 + 방향 벡터의 결과값)를 저장한다.
	2. 2개의 점에 각각 압축된 행렬을 적용한다.
	3. 점 2에서 점 1을 빼 방향 벡터를 복구한다.
3. 최적화
	1. 카메라가 도형 안쪽에 위치하는지 검사한다 -> Black Screen
	2. 광원이 도형 안쪽에 위치하는지 검사한다 -> 광원 삭제
	3. 광원이 절두체로부터 일정 거리 이상 떨어져 있다 -> 광원 삭제
	4. 도형이 절투체 바깥에 위치하는지 검사한다 -> 안쪽에 위치하는 도형에만 별도로 태그
4. 투영 평면의 위치를 계산한다.
5. 카메라 -> 투영 평면 방향으로, 스크린의 각 픽셀에 대응하는 위치로 광선을 발사한다.
6. 3-4에서 태그하였던 도형들과 광선의 충돌 테스트를 진행한다.(이 때, 벡터의 내적을 계산하여 충돌 지점이 카메라를 등지고 있는 경우는 배제한다.) 충돌하는 도형이 여러 개일 경우, 가장 충돌 거리가 가까운 지점을 계산에 사용한다.
7. 충돌 지점이 산출되면, 충돌한 도형의 종류를 고려하여 법선벡터를 산출한 후, 충돌 지점과 법선 벡터를 저장한다.
8. 충돌 지점과 광원을 잇는 선분의 방정식을 구한다.
9. 8에서 구한 선분과 존재하는 모든 도형과의 충돌 테스트를 진행한다. 만약 한 번이라도 충돌이 있으면 픽셀에 색상 가중치를 주지 않는다.
10. 충돌이 없다면, (광원의 위치 - 충돌 지점)인 벡터 l을 구한 후 정규화하여 7에서 저장한 법선 벡터와 내적하여 픽셀의 색상 가중치를 계산한다.
11. 