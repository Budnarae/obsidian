
---

#asynchronism 

_Deadlock_

---

# 교착 상태란

**교착 상태**(膠着狀態) 또는 **데드락 deadlock**은 두 개 이상의 작업이 서로 상대방의 작업이 끝나기 만을 기다리고 있기 때문에 결과적으로 아무것도 완료되지 못하는 상태이다.

# 교착 상태의 조건

1971년에 E. G. 코프만 교수는 교착상태가 일어나려면 다음과 같은 네 가지 필요 조건을 충족시켜야 함을 보였다.

1. 상호배제(Mutual exclusion) : 프로세스들이 필요로 하는 자원에 대해 배타적인 통제권을 요구한다.
2. 점유대기(Hold and wait) : 프로세스가 할당된 자원을 가진 상태에서 다른 자원을 기다린다.
3. 비선점(No preemption) : 프로세스가 어떤 자원의 사용을 끝낼 때까지 그 자원을 뺏을 수 없다.
4. 순환대기(Circular wait) : 각 프로세스는 순환적으로 다음 프로세스가 요구하는 자원을 가지고 있다.

이 조건 중에서 한 가지라도 만족하지 않으면 교착 상태는 발생하지 않는다.

# 교착 상태의 관리

## 교착 상태 방지(예방)

4가지 교착 상태 조건 중 하나라도 발생하지 않도록 한다.

### 상호배제 조건은 거부할 수 없다.

상호배제 조건을 거부하면 데이터 경쟁의 위험이 있기 때문이다.

### 점유와 대기 조건 거부

==최대 자원 할당==
프로세스가 작업을 수행하기 전에 필요한 모든 자원을 요청하고 획득해야 한다.
보류 상태에서는 프로세스가 자원을 점유할 수 없으므로 대기 조건이 성립되지 않는다.

자원의 효율성이 낮다는 단점이 있다. 많은 자원이 사용되지 않으면서 오랜 시간 할당되기 때문이다.

### 비선점 조건 거부

자원을 보유한 프로세스는 추가적인 자원 요청을 할 수 없다.
해당 프로세스는 일단 보유한 자원을 반납한 후 추가로 필요한 자원과 함께 한꺼번에 다시 요청해야 한다(시스템에 의해 선점 당하게 됨).

프로세스가 재시작되어야 하는 추가적인 부하가 발생한다.

### 순환 대기 조건 거부

자원에 대한 선형 순서를 사용한다.
다른 방법에 비해 효율적인 자원 사용량이 효율적이다.

자원의 요구에 대해 동적이거나 유연하지 못하다는 단점이 있다.

> 자원에 대한 선형순서
> 시스템이 관리하는 프린터, 스캐너, 파일 등 자원마다 고유 번호를 할당한다.
> 프로세스는 오름차순을 지키며 필요한 자원을 요청해야 한다.
> 예상된 순서와 다르게 자원을 요구하는 작업은 자원 낭비를 초래한다.

## 교착 상태 회피

교착 상태의 예방보다 덜 엄격한 조건을 요구함으로서 자원을 좀 더 효율적으로 사용하는 것을 목적으로 한다.

### 은행원 알고리즘(banker's algorithm)

프로세스가 요청한 자원을 할당할 때, 교착상태가 발생할 수 있다면 요청된 자원을 할당하지 않는다.
시스템은 관리하는 모든 자원을 자원 유형으로 그룹화한다.

os의 모든 프로세스가 작업을 유한 시간 내에 완료하는 것이 보장되어 있는 상태를 안정 상태라고 한다.

시스템이 교착 상태에 있지 않지만, 프로세스의 작업을 유한 시간 내에 완료되는 것을 보장하지 못하는(= 교착 상태에 빠질 가능성이 있는) 상태를 불안정 상태라고 한다.