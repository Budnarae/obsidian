---
tags:
  - graphics
  - translation
---

_계단식 그림자 맵_

---

[원문](https://developer.download.nvidia.com/SDK/10.5/opengl/src/cascaded_shadow_maps/doc/cascaded_shadow_maps.pdf)

---

# 계층형 그림자 맵 (Cascaded Shadow Maps)

Rouslan Dimitrov  
NVIDIA Corporation

## 계층형 그림자 맵

### 문서 변경 이력

|버전|날짜|책임자|변경 사유|
|---|---|---|---|
|1.0||Rouslan Dimitrov|최초 릴리스|
|1.1||Miguel Sainz|그림 및 사소한 편집 수정|

## 계층형 그림자 맵

그림자 맵은 게임 엔진에서 사실적인 그림자를 얻기 위해 매우 인기 있는 기법입니다. 넓은 공간에 이를 사용하려고 할 때, 그림자 맵은 조정하기 더 어려워지고 표면 여드름(surface acne)과 앨리어싱을 나타낼 가능성이 더 높아집니다. 계층형 그림자 맵(CSM)은 뷰어 근처에서는 깊이 텍스처의 더 높은 해상도를 제공하고 멀리 있는 곳에서는 더 낮은 해상도를 제공함으로써 앨리어싱 문제를 해결하는 데 도움이 되는 알려진 접근법입니다. 이는 카메라 뷰 절두체를 분할하고 화면 오류를 일정하게 만들기 위한 시도로 각 파티션에 대해 별도의 깊이 맵을 생성함으로써 수행됩니다.

CSM은 일반적으로 넓은 지형에 대해 태양이 드리우는 그림자에 사용됩니다. 모든 것을 단일 그림자 맵에 캡처하려면 매우 높고 비현실적인 해상도가 필요할 것입니다. 따라서 여러 개의 그림자 맵이 사용됩니다 - 가까운 객체만을 커버하여 각각이 상세한 그림자를 드리우는 그림자 맵; 거친 해상도로 멀리 있는 모든 것을 캡처하는 또 다른 그림자 맵과 선택적으로 그 사이에 몇 가지 더 많은 그림자 맵들. 이러한 분할은 합리적인데, 멀리 있는 객체들이 드리우는 그림자는 화면 공간에서 단지 몇 픽셀만을 차지하고 가까이 있는 객체들은 화면의 상당 부분을 차지하는 그림자를 드리울 수 있기 때문입니다.

그림 1-1은 평행 분할 CSM의 개략도를 보여주는데, 여기서 분할은 근거리 평면과 원거리 평면에 평행한 평면이며 각 슬라이스는 그 자체로 절두체입니다. 태양은 방향성 광원이므로 연관된 라이트 절두체들은 박스입니다(빨간색과 파란색으로 표시).

알고리즘은 다음과 같이 진행됩니다:
• 모든 라이트의 절두체에 대해, 라이트의 관점에서 장면 깊이를 렌더링합니다.
• 카메라의 관점에서 장면을 렌더링합니다. 프래그먼트의 z 값에 따라 조회할 적절한 그림자 맵을 선택합니다.

그림 1-1. 가장 오른쪽 나무는 근거리 그림자 맵에 캡처되고 다른 두 개는 왼쪽에 있습니다. 측면의 뷰어가 볼 때 왼쪽 그림자는 블록 모양이지만, 카메라는 세 그림자 모두를 대략 동일한 앨리어싱으로 인식할 것입니다.

---

## 관련 연구 (Related Work)

화면 공간 앨리어싱 오류를 개선하려는 여러 가지 다른 인기 있는 접근법들이 있습니다. 여기에 언급된 것들은 전통적으로 전체 뷰 절두체에 대해 작동합니다. 이러한 기법들을 CSM의 모든 절두체 슬라이스에 적용할 수는 있지만, 이는 시각적 품질을 크게 향상시키지 않으며 훨씬 더 큰 알고리즘 복잡성의 비용이 따릅니다. 사실, CSM은 원근 그림자 맵의 이산화로 생각할 수 있습니다.

**원근 그림자 맵 (Perspective Shadow Maps, PSM) [2]** – 그림 1-1은 라이트 절두체의 일부가 잠재적 차폐물을 포함하지 않고 카메라 뷰 절두체 밖에 있으며 이 그림자 맵의 부분이 낭비됨을 보여줍니다. PSM의 핵심 아이디어는 라이트 절두체를 정확히 뷰 절두체와 일치하도록 래핑하는 것입니다. 대략적으로, 이는 현재 카메라의 후-원근 공간에서 표준 그림자 매핑을 적용함으로써 달성됩니다. 이 방법의 단점은 광원의 위치와 유형이 직관적이지 않게 변경되므로 이 방법이 컴퓨터 게임에서 그다지 일반적이지 않다는 것입니다.

**라이트 공간 원근 그림자 맵 (Light Space Perspective Shadow Maps, LiPSM) [4]**은 광원의 방향을 변경하지 않는 방식으로 카메라 절두체를 래핑합니다. 라이트 방향에 수직인 시선 광선을 가진 새로운 라이트 절두체가 구축됩니다(그림자 맵에 평행). 절두체는 카메라 절두체와 잠재적 그림자 캐스터를 포함하도록 적절하게 크기가 조정됩니다. PSM과 비교하여 LiPSM은 특수한 경우가 많지 않지만 그림자 맵 텍스처를 완전히 사용하지 못합니다.

**사다리꼴 그림자 맵 (Trapezoidal Shadow Maps, TSM) [5]**은 라이트에서 볼 때 카메라 절두체의 경계 사다리꼴(LiPSM의 절두체 대신)을 구축합니다. 알고리즘은 다른 접근법과 유사하게 진행됩니다.

---