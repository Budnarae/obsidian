
---

#docker

*docker command는 상위 커맨드와 하위 커맨드로 이루어져 있다.*

---

[[도커]]는 **도커 명령어**를 사용하여 조작한다.

도커 명령어는 일반적으로 아래의 형식을 취한다.

`docker <상위 커맨드><하위 커맨드> <옵션> <대상> <인자>`

| 요소        | 의미                                                                    | 필수 여부         | 예시                                           |
| ----------- | ----------------------------------------------------------------------- | ----------------- | ---------------------------------------------- |
| 상위 커맨드 | 도커를 이루는 여러 카테고리 중 무엇을 명령의 대상으로 삼을 지 규정      | O(container 예외) | `container, image, network, volume`             |
| 하위 커맨드 | 상위 커맨드를 대상으로 어떠한 동작을 할 지 규정                         | O                 | `ls, run, inspect, stop`                         |
| 옵션        | 하위 커맨드의 세부적인 동작을 규정.                                     | X                 | `-i, -t, -d, --name, -p, -v`                     |
| 대상        | 상위 커맨드 범위 내에서 정확히 어떤 대상을 명령의 대상으로 삼을 지 규정 | X                 | `컨테이너 이름, 이미지 이름, 네트워크 이름 등등` |
| 인자        | 대상에 전달할 값을 지정                                                 | X                 | `httpd`                                          |

==상위 커맨드는 원칙적으로 삭제될 수 없으나 상위 커맨드가 container인 경우, 그리고 version 같은 특수한 커맨드를 사용하는 경우엔 예외로 한다.==

## 상위 커맨드

### 들어가기에 앞서

1. 대상이 id를 가지고 있을 경우, 대상의 이름 대신 id를 입력하여 커맨드를 입력할 수 있다. 보통 2~3 글자만 입력하여도 된다.
2. 아래 서술에서 옵션, 인자에 대한 설명이 없는 커맨드는 옵션, 인자를 거의 활용하지 않거나, 아예 없는 커맨드이다.

### container

#### run

컨테이너를 생성해 실행하는 커맨드이다. docker image pull, docker container create, docker container start의 기능을 하나로 합친 것과 같다. 현재 해당 이미지를 내려받은 상태가 아니라면 먼저 이미지를 내려받는다.

기본적으로 다음의 형식을 가진다.

`docker run <옵션> <대상 : 컨테이너를 만드는데 사용할 이미지의 이름> <인자>`

| 옵션                                   | 내용                                                  |
| -------------------------------------- | ----------------------------------------------------- |
| `--name <컨테이너 이름>`               | 컨테이너의 이름을 지정함                              |
| `-p 호스트_포트번호:컨테이너_포트번호` | 컨테이너의 포트와 호스트의 포트를 연결함(포트 포워딩) |
| `-v 호스트_디스크:컨테이너_디렉터리`   | 볼륨을 마운트함                                       |
| `--net=네트워크_이름`                  | 컨테이너를 네트워크에 연결함                          |
| `-e 환경변수_이름=값`                  | 환경 변수를 설정함                                    |
| `-d`                                   | 백그라운드로 실행함                                   |
| `-i`                                   | 컨테이너에 터미널(키보드)를 연결함                    |
| `-t`                                   | 특수 키를 사용 가능하도록 함                          |
| `-help`                                | 사용 방법 안내 메세지를 출력함                        |

==-d를 붙이지 않고 컨테이너를 실행하면 실행된 컨테이너가 프로그램의 실행을 마칠 때까지 터미널의 제어를 차지하므로 그다음 명령을 입력할 수 없는 상태가 된다.== 
==또한 -it 옵션을 붙이지 않으면 컨테이너 안의 파일 시스템에 접근할 수 없다.==

#### ps

컨테이너의 목록을 출력하는 커맨드.

`docker ps`는 현재 실행 중인 컨테이너의 목록을 출력한다.
`docker ps -a`는 모든 컨테이너의 목록을 출력한다.

#### 그 외

| 커맨드 | 내용                                                     | 형식                                 |
| ------ | -------------------------------------------------------- | ------------------------------------ |
| stop   | 컨테이너 정지                                            | `docker stop <대상 : 컨테이너_이름>` |
| rm     | 컨테이너 삭제, 삭제 전에 stop으로 컨테이너를 정지해야 함 | `docker rm <대상 : 컨테이너_이름>`   |
| logs   | 컨테이너의 log, error log 등을 출력                      | `docker logs <대상 : 컨테이너_이름>` |

### image

| 커맨드 | 내용             | 형식                                          |
| ------ | ---------------- | --------------------------------------------- |
| ls     | 이미지 목록 출력 | `docker image ls`                             |
| rm     | 이미지 삭제      | `docker image rm <대상 : 삭제할 이미지 이름>` |

#### 이미지 버전과 이미지 이름

이미지를 대상으로 하는 명령어는 버전을 지정하지 않아도 아래와 같이 동작한다.

`docker run --name ubuntoCont -it ubuntu'

그러면 이미지의 최신 버전(latest tag)을 내려받는다.
하지만 특정 버전을 사용해야 할 때도 있다. 그런 경우에는 아래와 같은 형식으로 버전을 지정할 수 있다.

`image:image_version`

### network

| 커맨드     | 내용                                                    | 형식                                           |
| ---------- | ------------------------------------------------------- | ---------------------------------------------- |
| connect    | 네트워크에 컨테이너를 새로이 접속                       |                                                |
| disconnect | 네트워크에서 컨테이너의 접속을 끊음                     |                                                |
| inspect    | 네트워크의 상세 정볼르 확인                             |                                                |
| ls         | 네트워크의 목록을 확인                                  |                                                |
| prune      | 현재 아무 컨테이너도 접속하지 않은 네트워크를 모두 삭제 |                                                |
| create     | 네트워크 생성                                           | `docker network create <대상 : 네트워크 이름>` |
| rm         | 지정한 네트워크를 삭제                                  | `docker network rm <대상 : 네트워크 이름>`     |

### volume



---

참고자료

#참고도서/그림과_실습으로_배우는_도커_쿠버네티스 

---